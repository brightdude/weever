#!/usr/bin/env node

// Copyright 2012-2014 (c) Peter Å irka <petersirka@gmail.com>
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var exec=require("child_process").exec;var fs=require("fs");var path=require("path");var os=require("os");var EOF=os.platform()==="win32"?"\r\n":"\n";var $type=1;function createDirectory(directory){var arr=[];arr.push("controllers");arr.push("node_modules");if($type<2){arr.push("views");arr.push("templates");arr.push("databases");arr.push("definitions");if($type==0){arr.push("components");arr.push("workers");arr.push("tests");arr.push("contents");arr.push("logs");arr.push("modules");arr.push("source")}arr.push("resources");arr.push("public");arr.push("tmp")}arr.forEach(function(o){var dir=path.join(directory,o);if(!fs.existsSync(dir))fs.mkdirSync(dir)})}function createDirectoryAngular(directory){var arr=[];arr.push("app");arr.push("controllers");arr.push("node_modules");arr.push("views");arr.forEach(function(o){var dir=path.join(directory,o);if(!fs.existsSync(dir))fs.mkdirSync(dir)});arr=[];arr.push("common");arr.push("controllers");arr.push("css");arr.push("directives");arr.push("filters");arr.push("resources");arr.push("services");arr.push("templates");arr.push("views");arr.forEach(function(o){var dir=path.join(directory,"app",o);if(!fs.existsSync(dir))fs.mkdirSync(dir)})}function createFiles(directory){createFileIndex(directory);createFileConfig(directory);if($type<2){createFileViews(directory);createFileResource(directory);createFilePublic(directory)}if($type===3){createFileViews(directory);createFilePublicAngular(directory);createFileControllerAngular(directory)}else createFileController(directory);if($type===0){createFileTest(directory);createFileModules(directory);createFileComponent(directory)}}function createFileIndex(directory){fs.writeFileSync(path.join(directory,"debug.js"),"Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQovLyBJTVBPUlRBTlQ6IG9ubHkgZm9yIGRldmVsb3BtZW50IG1vZGUNCi8vIHRvdGFsLmpzIC0gd2ViIGFwcGxpY2F0aW9uIGZyYW1ld29yayBmb3Igbm9kZS5qcw0KLy8gaHR0cDovL3d3dy50b3RhbGpzLmNvbQ0KLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCnZhciBmcyA9IHJlcXVpcmUoImZzIik7DQoNCnZhciBodHRwcyA9IGZhbHNlOw0KdmFyIG9wdGlvbnMgPSB7IGtleTogbnVsbCwgY2VydDogbnVsbCB9Ow0KDQp2YXIgaXNEZWJ1Z2dpbmc9cHJvY2Vzcy5hcmd2W3Byb2Nlc3MuYXJndi5sZW5ndGgtMV09PT0iZGVidWdnaW5nIjt2YXIgZGlyZWN0b3J5PXByb2Nlc3MuY3dkKCk7dmFyIHBhdGg9cmVxdWlyZSgicGF0aCIpO2Z1bmN0aW9uIGRlYnVnKCl7dmFyIGZyYW1ld29yaz1yZXF1aXJlKCJ0b3RhbC5qcyIpO3ZhciBwb3J0PXBhcnNlSW50KHByb2Nlc3MuYXJndlsyXSk7ZnJhbWV3b3JrLnJ1bihyZXF1aXJlKGh0dHBzPyJodHRwcyI6Imh0dHAiKSx0cnVlLHBvcnQsIiIsb3B0aW9ucyYmb3B0aW9ucy5rZXkmJm9wdGlvbnMuY2VydD9vcHRpb25zOm51bGwpfWZ1bmN0aW9uIGFwcCgpe3ZhciBmb3JrPXJlcXVpcmUoImNoaWxkX3Byb2Nlc3MiKS5mb3JrO3ZhciB1dGlscz1yZXF1aXJlKCJ0b3RhbC5qcy91dGlscyIpO3ZhciBkaXJlY3Rvcmllcz1bZGlyZWN0b3J5KyIvY29udHJvbGxlcnMiLGRpcmVjdG9yeSsiL2RlZmluaXRpb25zIixkaXJlY3RvcnkrIi9tb2R1bGVzIixkaXJlY3RvcnkrIi9yZXNvdXJjZXMiLGRpcmVjdG9yeSsiL2NvbXBvbmVudHMiLGRpcmVjdG9yeSsiL21vZGVscyIsZGlyZWN0b3J5KyIvc291cmNlIl07dmFyIGZpbGVzPXt9O3ZhciBmb3JjZT1mYWxzZTt2YXIgY2hhbmdlcz1bXTt2YXIgYXBwPW51bGw7dmFyIHN0YXR1cz0wO3ZhciBhc3luYz1uZXcgdXRpbHMuQXN5bmM7dmFyIHBpZD0iIjt2YXIgcGlkSW50ZXJ2YWw9bnVsbDt2YXIgcHJlZml4PSItLS0tLS0tLS0tLS0+ICI7dmFyIGlzTG9hZGVkPWZhbHNlO2Z1bmN0aW9uIG9uRmlsdGVyKHBhdGgsaXNEaXJlY3Rvcnkpe3JldHVybiBpc0RpcmVjdG9yeT90cnVlOnBhdGguaW5kZXhPZigiLmpzIikhPT0tMXx8cGF0aC5pbmRleE9mKCIucmVzb3VyY2UiKSE9PS0xfWZ1bmN0aW9uIG9uQ29tcGxldGUoKXt2YXIgc2VsZj10aGlzO2ZzLnJlYWRkaXIoZGlyZWN0b3J5LGZ1bmN0aW9uKGVycixhcnIpe3ZhciBsZW5ndGg9YXJyLmxlbmd0aDtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3ZhciBuYW1lPWFycltpXTtpZihuYW1lPT09ImNvbmZpZyJ8fG5hbWU9PT0iY29uZmlnLWRlYnVnInx8bmFtZT09PSJjb25maWctcmVsZWFzZSJ8fG5hbWU9PT0idmVyc2lvbnMifHxuYW1lLmluZGV4T2YoIi5qcyIpIT09LTF8fG5hbWUuaW5kZXhPZigiLnJlc291cmNlIikhPT0tMSlzZWxmLmZpbGUucHVzaChuYW1lKX1sZW5ndGg9c2VsZi5maWxlLmxlbmd0aDtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3ZhciBuYW1lPXNlbGYuZmlsZVtpXTtpZighZmlsZXNbbmFtZV0pZmlsZXNbbmFtZV09aXNMb2FkZWQ/MDpudWxsfXJlZnJlc2goKX0pfWZ1bmN0aW9uIHJlZnJlc2goKXt2YXIgZmlsZW5hbWVzPU9iamVjdC5rZXlzKGZpbGVzKTt2YXIgbGVuZ3RoPWZpbGVuYW1lcy5sZW5ndGg7Zm9yKHZhciBpPTA7aTxsZW5ndGg7aSsrKXt2YXIgZmlsZW5hbWU9ZmlsZW5hbWVzW2ldOyhmdW5jdGlvbihmaWxlbmFtZSl7YXN5bmMuYXdhaXQoZnVuY3Rpb24obmV4dCl7ZnMuc3RhdChmaWxlbmFtZSxmdW5jdGlvbihlcnIsc3RhdCl7aWYoIWVycil7dmFyIHRpY2tzPXN0YXQubXRpbWUuZ2V0VGltZSgpO2lmKGZpbGVzW2ZpbGVuYW1lXSE9PW51bGwmJmZpbGVzW2ZpbGVuYW1lXSE9PXRpY2tzKXtjaGFuZ2VzLnB1c2gocHJlZml4K2ZpbGVuYW1lLnJlcGxhY2UoZGlyZWN0b3J5LCIiKSsoZmlsZXNbZmlsZW5hbWVdPT09MD8iIChhZGRlZCkiOiIgKG1vZGlmaWVkKSIpKTtmb3JjZT10cnVlfWZpbGVzW2ZpbGVuYW1lXT10aWNrc31lbHNle2RlbGV0ZSBmaWxlc1tmaWxlbmFtZV07Y2hhbmdlcy5wdXNoKHByZWZpeCtmaWxlbmFtZS5yZXBsYWNlKGRpcmVjdG9yeSwiIikrIiAocmVtb3ZlZCkiKTtmb3JjZT10cnVlfW5leHQoKX0pfSl9KShmaWxlbmFtZSl9YXN5bmMuY29tcGxldGUoZnVuY3Rpb24oKXtpc0xvYWRlZD10cnVlO3NldFRpbWVvdXQocmVmcmVzaF9kaXJlY3RvcnksMmUzKTtpZihzdGF0dXMhPT0xKXJldHVybjtpZighZm9yY2UpcmV0dXJuO3Jlc3RhcnQoKTt2YXIgbGVuZ3RoPWNoYW5nZXMubGVuZ3RoO2Zvcih2YXIgaT0wO2k8bGVuZ3RoO2krKyljb25zb2xlLmxvZyhjaGFuZ2VzW2ldKTtjaGFuZ2VzPVtdO2ZvcmNlPWZhbHNlfSl9ZnVuY3Rpb24gcmVmcmVzaF9kaXJlY3RvcnkoKXt1dGlscy5scyhkaXJlY3RvcmllcyxvbkNvbXBsZXRlLG9uRmlsdGVyKX1mdW5jdGlvbiByZXN0YXJ0KCl7aWYoYXBwIT09bnVsbCl7dHJ5e3Byb2Nlc3Mua2lsbChhcHAucGlkKX1jYXRjaChlcnIpe31hcHA9bnVsbH12YXIgYXJyPXByb2Nlc3MuYXJndjthcnIucG9wKCk7YXJyLnB1c2goImRlYnVnZ2luZyIpO2FwcD1mb3JrKHBhdGguam9pbihkaXJlY3RvcnksImRlYnVnLmpzIiksYXJyKTthcHAub24oIm1lc3NhZ2UiLGZ1bmN0aW9uKG1zZyl7aWYobXNnLnN1YnN0cmluZygwLDUpPT09Im5hbWU6Iil7cHJvY2Vzcy50aXRsZT0iZGVidWc6ICIrbXNnLnN1YnN0cmluZyg2KTtyZXR1cm59fSk7YXBwLm9uKCJleGl0IixmdW5jdGlvbigpe2lmKHN0YXR1cyE9PTI1NSlyZXR1cm47YXBwPW51bGx9KTtpZihzdGF0dXM9PT0wKWFwcC5zZW5kKCJkZWJ1Z2dpbmciKTtzdGF0dXM9MX1wcm9jZXNzLm9uKCJTSUdURVJNIixlbmQpO3Byb2Nlc3Mub24oIlNJR0lOVCIsZW5kKTtwcm9jZXNzLm9uKCJleGl0IixlbmQpO2Z1bmN0aW9uIGVuZCgpe2lmKGFyZ3VtZW50cy5jYWxsZWUuaXNFbmQpcmV0dXJuO2FyZ3VtZW50cy5jYWxsZWUuaXNFbmQ9dHJ1ZTtmcy51bmxpbmsocGlkLG5vb3ApO2lmKGFwcD09PW51bGwpe3Byb2Nlc3MuZXhpdCgwKTtyZXR1cm59cHJvY2Vzcy5raWxsKGFwcC5waWQpO2FwcD1udWxsO3Byb2Nlc3MuZXhpdCgwKX1mdW5jdGlvbiBub29wKCl7fWlmKHByb2Nlc3MucGlkPjApe2NvbnNvbGUubG9nKHByZWZpeCsiUElEOiAiK3Byb2Nlc3MucGlkKTtwaWQ9cGF0aC5qb2luKGRpcmVjdG9yeSwiZGVidWcucGlkIik7ZnMud3JpdGVGaWxlU3luYyhwaWQscHJvY2Vzcy5waWQpO3BpZEludGVydmFsPXNldEludGVydmFsKGZ1bmN0aW9uKCl7ZnMuZXhpc3RzKHBpZCxmdW5jdGlvbihleGlzdCl7aWYoZXhpc3QpcmV0dXJuO2ZzLnVubGluayhwaWQsbm9vcCk7aWYoYXBwIT09bnVsbClwcm9jZXNzLmtpbGwoYXBwLnBpZCk7cHJvY2Vzcy5leGl0KDApfSl9LDJlMyl9cmVzdGFydCgpO3JlZnJlc2hfZGlyZWN0b3J5KCl9aWYoaXNEZWJ1Z2dpbmcpZGVidWcoKTtlbHNlIGlmKCFmcy5leGlzdHNTeW5jKHBhdGguam9pbihkaXJlY3RvcnksImRlYnVnLnBpZCIpKSlhcHAoKTs=","base64");fs.writeFileSync(path.join(directory,"release.js"),"dmFyIGZyYW1ld29yayA9IHJlcXVpcmUoJ3RvdGFsLmpzJyk7DQp2YXIgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTsNCg0KZnJhbWV3b3JrLnJ1bihodHRwLCBmYWxzZSwgcGFyc2VJbnQocHJvY2Vzcy5hcmd2WzJdKSk7","base64");fs.writeFileSync(path.join(directory,"test.js"),"dmFyIGZyYW1ld29yayA9IHJlcXVpcmUoJ3RvdGFsLmpzJyk7DQp2YXIgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTsNCg0KZnJhbWV3b3JrLnJ1bihodHRwLCB0cnVlLCBwYXJzZUludChwcm9jZXNzLmFyZ3ZbMl0pKTsNCg0KZnJhbWV3b3JrLnRlc3QodHJ1ZSwgZnVuY3Rpb24oKSB7DQoJY29uc29sZS5sb2coJycpOw0KCWNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7DQoJY29uc29sZS5sb2coJ0NvbmdyYXR1bGF0aW9ucywgdGhlIHRlc3Qgd2FzIHN1Y2Nlc3NmdWwhJyk7DQoJY29uc29sZS5sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTsNCgljb25zb2xlLmxvZygnJyk7DQp9KTs=","base64")}function createFileConfig(directory){var buffer=[];buffer.push("name                     : My web site");buffer.push("author                   : Your company name");buffer.push("");buffer.push("// Mail settings");buffer.push("mail.smtp                : smtp.yourwebsite.com");buffer.push('mail.smtp.options        : "{"secure":false,"port":25,"user":"","password":"","timeout":10000}"');buffer.push("mail.address.from        : your@yourwebsite.com");buffer.push("mail.address.reply       : your@yourwebsite.com");buffer.push("mail.address.bcc         : ");fs.writeFileSync(path.join(directory,"config"),buffer.join(EOF));buffer=[];buffer.push("default-ip               : 127.0.0.1");buffer.push("default-port             : 8000");buffer.push("");buffer.push("secret                   : your-secret-key");buffer.push("version                  : 1.01");if($type===3){buffer.push("");buffer.push("// CloudFlare cdnjs");buffer.push("angular-version          : 1.2.16");buffer.push("");buffer.push("// CloudFlare cdnjs");buffer.push("angular-i18n-version     : 1.2.15")}fs.writeFileSync(path.join(directory,"config-release"),buffer.join(EOF));fs.writeFileSync(path.join(directory,"config-debug"),buffer.join(EOF).replace(/true/g,"false"))}function createFileViews(directory){var buffer=[];var dir=path.join(directory,"views");if(!fs.existsSync(dir))fs.mkdirSync(dir);buffer.push("@{meta('title', 'description', 'keywords')}");if($type===3){buffer.push("");buffer.push("<!-- /app/css/ -->");buffer.push("@{ngStyle('app')}");buffer.push("");buffer.push("<!-- cdnjs -->");buffer.push("@{ngLocale('en-us')}");buffer.push("");buffer.push("<!-- /app/controllers/ -->");buffer.push("@{ngController('home', 'user')}");buffer.push("");buffer.push('<div ng-controller="HomeCtrl">{{ name }}</div>')}else{buffer.push("");buffer.push("<div>Hello world!</div>")}if($type===3)fs.writeFileSync(path.join(dir,"app.html"),buffer.join("\n"));else fs.writeFileSync(path.join(dir,"homepage.html"),buffer.join("\n"));buffer=[];if($type===3){buffer.push("");buffer.push("@{ng('angular', 'resource', 'route')}");buffer.push("")}buffer.push("<!DOCTYPE html>");if($type===3)buffer.push('<html ng-app="app">');else buffer.push("<html>");buffer.push("<head>");buffer.push("    @{meta}");buffer.push('    <meta charset="utf-8" />');buffer.push('    <meta http-equiv="X-UA-Compatible" content="IE=10" />');buffer.push('    <meta name="format-detection" content="telephone=no" />');buffer.push('    <meta name="viewport" content="width=1024, user-scalable=yes" />');buffer.push('    <meta name="robots" content="all,follow" />');buffer.push("    @{head}");if($type!==3){buffer.push("    @{css('default.css')}");buffer.push('    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>');buffer.push("    @{js('default.js')}")}buffer.push("    @{favicon('favicon.ico')}");buffer.push("</head>");buffer.push("<body>");buffer.push("");buffer.push("    @{body}");buffer.push("");buffer.push("</body>");buffer.push("</html>");fs.writeFileSync(path.join(dir,"_layout.html"),buffer.join(EOF))}function createFileResource(directory){var dir=path.join(directory,"resources");fs.writeFileSync(path.join(dir,"default.resource"),"name                : value"+EOF)}function createFilePublicAngular(directory){var dir=path.join(directory,"app");var css=path.join(dir,"css");var controllers=path.join(dir,"controllers");var buffer=[];buffer.push("User-agent: *");buffer.push("Allow: /");buffer.push("");fs.writeFileSync(path.join(dir,"robots.txt"),buffer.join(EOF));fs.writeFileSync(path.join(css,"app.css"),"LyphdXRvKi8NCg0KLyoNCiAgICB2YXIgY29sb3IgPSAnY29sb3I6cmVkJzsNCiAgICB2YXIgd2lkdGggPSAnOTQwcHgnOw0KKi8NCg0KYm9keSB7IHBhZGRpbmc6MjBweDsgbWFyZ2luOjA7IGZvbnQ6bm9ybWFsIDEycHggQXJpYWw7IGNvbG9yOiM1MDUwNTA7IH0NCg0KLmNvbnRlbnQgeyBtYXJnaW46MCBhdXRvOyB3aWR0aDogJHdpZHRoOyBwYWRkaW5nOiAxMHB4OyBib3JkZXItcmFkaXVzOiA1cHg7ICRjb2xvcjsgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSgwLDAsMCwwLjUpOyBhbmltYXRpb246IG15QW5pbWF0aW9uIDVzIGFsdGVybmF0ZTsgfQ0KDQoubGlzdCB7IGJvcmRlci1ib3R0b206MXB4IHNvbGlkICNFMEUwRTA7IHBhZGRpbmctYm90dG9tOjVweDsgbWFyZ2luLWJvdHRvbTo1cHg7IH0NCi5saXN0ID4gZGl2OmZpcnN0LWNoaWxkIHsgZm9udC1zaXplOiAxNXB4OyB9DQoNCkBrZXlmcmFtZXMgbXlBbmltYXRpb24NCnsNCgkwJSAgIHsgYmFja2dyb3VuZDogd2hpdGU7IH0NCgkyNSUgIHsgYmFja2dyb3VuZDogI0YwRjBGMDsgfQ0KCTUwJSAgeyBiYWNrZ3JvdW5kOiAjRDBEMEQwOyB9DQoJMTAwJSB7IGJhY2tncm91bmQ6ICNFMEUwRTA7IH0NCn0=","base64");buffer=[];buffer.push("var app = angular.module('app', []);");buffer.push("");fs.writeFileSync(path.join(dir,"app.js"),buffer.join(EOF));buffer=[];buffer.push("function HomeCtrl($scope) {\n    $scope.name = 'total.js + angular.js = awesome';\n}");fs.writeFileSync(path.join(controllers,"home.js"),buffer.join(EOF));buffer=[];buffer.push("function UserCtrl($scope) {\n    // example\n}");fs.writeFileSync(path.join(controllers,"user.js"),buffer.join(EOF))}function createFilePublic(directory){var dir=path.join(directory,"public");var css=path.join(dir,"css");var js=path.join(dir,"js");var img=path.join(dir,"img");fs.writeFileSync(path.join(dir,"favicon.ico"),"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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","base64");if($type===3)return;if(!fs.existsSync(js))fs.mkdirSync(js);if(!fs.existsSync(css))fs.mkdirSync(css);if(!fs.existsSync(img))fs.mkdirSync(img);var buffer=[];buffer.push("User-agent: *");buffer.push("Allow: /");buffer.push("");fs.writeFileSync(path.join(dir,"robots.txt"),buffer.join(EOF));fs.writeFileSync(path.join(css,"default.css"),"LyphdXRvKi8NCg0KLyoNCiAgICB2YXIgY29sb3IgPSAnY29sb3I6cmVkJzsNCiAgICB2YXIgd2lkdGggPSAnOTQwcHgnOw0KKi8NCg0KYm9keSB7IHBhZGRpbmc6MjBweDsgbWFyZ2luOjA7IGZvbnQ6bm9ybWFsIDEycHggQXJpYWw7IGNvbG9yOiM1MDUwNTA7IH0NCg0KLmNvbnRlbnQgeyBtYXJnaW46MCBhdXRvOyB3aWR0aDogJHdpZHRoOyBwYWRkaW5nOiAxMHB4OyBib3JkZXItcmFkaXVzOiA1cHg7ICRjb2xvcjsgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSgwLDAsMCwwLjUpOyBhbmltYXRpb246IG15QW5pbWF0aW9uIDVzIGFsdGVybmF0ZTsgfQ0KDQoubGlzdCB7IGJvcmRlci1ib3R0b206MXB4IHNvbGlkICNFMEUwRTA7IHBhZGRpbmctYm90dG9tOjVweDsgbWFyZ2luLWJvdHRvbTo1cHg7IH0NCi5saXN0ID4gZGl2OmZpcnN0LWNoaWxkIHsgZm9udC1zaXplOiAxNXB4OyB9DQoNCkBrZXlmcmFtZXMgbXlBbmltYXRpb24NCnsNCgkwJSAgIHsgYmFja2dyb3VuZDogd2hpdGU7IH0NCgkyNSUgIHsgYmFja2dyb3VuZDogI0YwRjBGMDsgfQ0KCTUwJSAgeyBiYWNrZ3JvdW5kOiAjRDBEMEQwOyB9DQoJMTAwJSB7IGJhY2tncm91bmQ6ICNFMEUwRTA7IH0NCn0=","base64");buffer=[];buffer.push("$(document).ready(function() {");buffer.push("");buffer.push("});");fs.writeFileSync(path.join(js,"default.js"),buffer.join(EOF))}function createFileModules(directory){var dir=path.join(directory,"modules");var buffer=[];buffer.push("exports.yourcode = function () {");buffer.push("    return 'Hello World';");buffer.push("};");fs.writeFileSync(path.join(dir,"example.js"),buffer.join(EOF))}function createFileControllerAngular(directory){var dir=path.join(directory,"controllers");var buffer=[];buffer.push("exports.install = function(framework) {");buffer.push("    framework.route('/*', view_app);");buffer.push("};");buffer.push("");buffer.push("function view_app() {");buffer.push("    var self = this;");buffer.push("    self.view('app');");buffer.push("}");fs.writeFileSync(path.join(dir,"default.js"),buffer.join(EOF))}function createFileController(directory){var dir=path.join(directory,"controllers");var buffer=[];buffer.push("exports.install = function(framework) {");buffer.push("    framework.route('/', view_homepage);");buffer.push("    framework.route('#400', error400);");buffer.push("    framework.route('#401', error401);");buffer.push("    framework.route('#403', error403);");buffer.push("    framework.route('#404', error404);");buffer.push("    framework.route('#408', error408);");buffer.push("    framework.route('#431', error431);");buffer.push("    framework.route('#500', error500);");buffer.push("};");buffer.push("");buffer.push("// Bad Request");buffer.push("function error400() {");buffer.push("    var self = this;");buffer.push("    self.status = 400;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Unauthorized");buffer.push("function error401() {");buffer.push("    var self = this;");buffer.push("    self.status = 401;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Forbidden");buffer.push("function error403() {");buffer.push("    var self = this;");buffer.push("    self.status = 403;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Not Found");buffer.push("function error404() {");buffer.push("    var self = this;");buffer.push("    self.status = 404;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Request Timeout");buffer.push("function error408() {");buffer.push("    var self = this;");buffer.push("    self.status = 408;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Request Header Fields Too Large");buffer.push("function error431() {");buffer.push("    var self = this;");buffer.push("    self.status = 431;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Internal Server Error");buffer.push("function error500() {");buffer.push("    var self = this;");buffer.push("    self.status = 500;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("function view_homepage() {");buffer.push("    var self = this;");if($type!==2)buffer.push("    self.view('homepage');");else buffer.push("    self.plain('homepage');");buffer.push("}");fs.writeFileSync(path.join(dir,"default.js"),buffer.join(EOF))}function createFileTest(directory){var dir=path.join(directory,"tests");var buffer=[];buffer.push("var assert = require('assert');");buffer.push("");buffer.push("exports.run = function(framework) {");buffer.push("");buffer.push("    framework.assert('Number validation', function(next, name) {");buffer.push("        assert.ok('1' === '1', name);");buffer.push("        next();");buffer.push("    });");buffer.push("");buffer.push("    framework.assert('Homepage', '/1/', ['xhr', 'json'], function(error, data, code, headers, cookies, name) {");buffer.push("        assert.ok(code === 200, name);");buffer.push("    }, { name: 'total.js (optional)' }, { cookie: 'value (optional)' }, { 'X-My-Header': 'optional' });");buffer.push("");buffer.push("};");fs.writeFileSync(path.join(dir,"default.js"),buffer.join(EOF))}function createFileComponent(directory){var dir=path.join(directory,"components");var buffer=[];buffer.push("// optional");buffer.push("exports.install = function(framework) {");buffer.push("	// component doesn't support routing");buffer.push("	console.log('OK');");buffer.push("};");buffer.push("");buffer.push("// optional");buffer.push("exports.usage = function(isDetailed) {");buffer.push("	return '';");buffer.push("};");buffer.push("");buffer.push("// optional");buffer.push("exports.configure = function(setup) {");buffer.push("");buffer.push("};");buffer.push("");buffer.push("// REQUIRED");buffer.push("exports.render = function(data) {");buffer.push("	// this === controller or this === framework");buffer.push("	return '';");buffer.push("};	");fs.writeFileSync(path.join(dir,"example.js"),buffer.join(EOF))}function install(directory){exec("npm install total.js",{cwd:directory},function(error,stdout,stderr){}).on("exit",function(){console.log("total.js: success")})}function display_help(){console.log("");console.log("-m or -minimal   = minimal");console.log("-n or -normal    = normal (default)");console.log("-f or -full      = full");console.log("-a or -angular   = for angular.js application");console.log("-v or -version   = total.js version");console.log("/path/           = target (default current directory)");console.log("")}function main(){var dir=process.cwd();for(var i=2;i<process.argv.length;i++){var arg=process.argv[i];var cmd=arg.toLowerCase();if(cmd==="-v"||cmd==="-version"){console.log(require("total.js").version);return}if(cmd==="-f"||cmd==="-full"||cmd==="full")continue;if(cmd==="-a"||cmd==="-angular"||cmd==="angular"){$type=3;continue}if(cmd==="-m"||cmd==="-minimal"||cmd==="-minimum"||cmd==="minimum"){$type=2;continue}if(cmd==="-n"||cmd==="-normal"||cmd==="normal"){$type=1;continue}if(cmd==="-h"||cmd==="-help"||cmd==="--help"||cmd==="help"){display_help();return}dir=arg;break}if(!fs.existsSync(dir)){console.log("total.js: error / directory not exists");return}var files=fs.readdirSync(dir);if(files.length>0){var can=true;for(var i=0;i<files.length;i++){var name=files[i];if(name[0]===".")continue;can=false}if(!can){console.log("total.js: error / directory is not empty");return}}console.log("total.js: creating directories");if($type!==3)createDirectory(dir);else createDirectoryAngular(dir);console.log("total.js: creating files");createFiles(dir);console.log("total.js: installing current version total.js");install(dir)}main();